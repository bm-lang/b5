# lambda Action();
#
# let x = 0;
# let action Action = () -> x + 1;
# action();

TYPE ActionLambda
FIELDS x AS int32

PROC ActionLambda_new
  PARAMS x AS int32
  RETURNS ActionLambda
BODY BEGIN
  DECLARE result AS ActionLambda WITH NEW ActionLambda
  SET REF result PICK x END VALUE REF x END
  RETURN result
END

PROC ActionLambda_run
  PARAM action AS ActionLambda
  RETURNS int32
BODY
  RETURN ADD REF action PICK x END WITH LITERAL `1` AS INT32
END

PROC main MAIN
BODY
  DECLARE x AS int32 WITH 0
  DECLARE action AS ActionLambda
    WITH FETCH ActionLambda_new ARG REF x END
  CALL ActionLambda_run
    ARG action
  END
END